<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Product List</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-300 p-10 ">
<div class="max-w-6xl mx-auto bg-white p-6 rounded shadow">

  <h2 class="text-2xl font-bold mb-4">Add Product</h2>

  <!-- ✅ multipart/form-data để upload -->
  <form action="/products/add" method="post" enctype="multipart/form-data"
        class="grid grid-cols-4 gap-4 mb-6">
    <input name="name" placeholder="Name" required class="border p-2 rounded">
    <input name="price" type="number" placeholder="Price" required class="border p-2 rounded">
    <input name="quantity" type="number" placeholder="Quantity" required class="border p-2 rounded">
    <input name="image" type="file" accept="image/*" class="border p-2 rounded">
    <button class="col-span-4 bg-blue-500 text-white py-2 rounded hover:bg-blue-600">
      Add
    </button>
  </form>

  <form method="get" action="/products" class="mb-4 flex gap-2">
    <input type="text" name="q" value="<%= q %>" placeholder="Search product name..."
           class="border p-2 rounded w-full">
    <button class="bg-green-500 text-white px-4 rounded hover:bg-green-600">Search</button>
  </form>

  <table class="w-full border border-gray-300">
    <thead class="bg-gray-200">
    <tr>
      <th class="border p-2">Image</th>
      <th class="border p-2">ID</th>
      <th class="border p-2">Name</th>
      <th class="border p-2">Price</th>
      <th class="border p-2">Quantity</th>
      <th class="border p-2">Action</th>
    </tr>
    </thead>

    <tbody>
    <% products.forEach(p => { %>
      <tr class="text-center hover:bg-gray-100">
        <td class="border p-2">
          <% if (p.url_image) { %>
            <img src="<%= p.url_image %>" class="w-16 h-16 object-cover rounded mx-auto" />
          <% } else { %>
            <span class="text-gray-400">No image</span>
          <% } %>
        </td>

        <td class="border p-2"><%= p.productId %></td>
        <td class="border p-2"><%= p.name %></td>
        <td class="border p-2"><%= p.price %></td>
        <td class="border p-2"><%= p.quantity %></td>

        <td class="border p-2">
          <div class="flex justify-center gap-2">
            <a href="/products/edit/<%= p.productId %>" class="bg-yellow-400 px-3 py-1 rounded">Edit</a>
            <form action="/products/delete/<%= p.productId %>" method="post">
              <button onclick="return confirm('Delete this product?')"
                      class="bg-red-500 text-white px-3 py-1 rounded">
                Delete
              </button>
            </form>
          </div>
        </td>
      </tr>
    <% }) %>
    </tbody>
  </table>

  <% if (products.length === 0) { %>
    <p class="text-center text-gray-500 mt-4">No products found</p>
  <% } %>

</div>
</body>
</html>
